import { Component, OnInit } from '@angular/core';
import * as L from 'leaflet';
import { Platform } from '@ionic/angular';
import { trigger, style, animate, transition } from '@angular/animations';
import { RouteModel } from 'src/app/models/route.model';
import { SharedService } from 'src/app/services/shared/shared.service';
import { Router } from '@angular/router';
import { LineString, MultiLineString } from 'geojson';

@Component({
  selector: 'app-display-route',
  templateUrl: './display-route.page.html',
  styleUrls: ['./display-route.page.scss'],
  animations: [
    trigger('openClose', [
      transition(':enter', [
        style({ transform: 'translateX(-100%)' }),
        animate('250ms ease-in', style({ transform: 'translateX(0%)' }))
      ]),
      transition(':leave', [
        animate('250ms ease-in', style({ transform: 'translateX(-100%)' }))
      ])
    ])
  ]
})
export class DisplayRoutePage implements OnInit {

  // Get if running on Desktop or mobile
  showSideMenu: boolean;
  // Map
  map: L.Map;
  // Close side menu when user click button
  isOpen: boolean;
  // Route to view in the map
  route: RouteModel
  // Segment highlighted & zoomed when instruction is selected
  stepSelected: L.Polyline;
  // Steps/instructions of walk & bike 
  segmentsSteps: Map<number, any>;
  // Store the segment color, the icon to display & if line is solid or dotted
  segmentsVisual: any[];

  constructor(
    private platform: Platform,
    private sharedService: SharedService,
    private router: Router
  ) { }

  ngOnInit() {
    this.platform.ready().then(() => {
      this.showSideMenu = this.platform.is('desktop');
    });

    // Different icon for the mode of transport
    let iconTransport: Map<string, string> = new Map<string, string>([['A pie', 'walk.png'], ['Metro', 'subway.png'],
    ['Bus', 'bus.png'], ['BiciMAD', 'bicycle.png'], ['Cercanías', 'commuter.png']]);
    // Map with line zones associated to general line
    let linesZone: Map<string, string> = new Map<string, string>([["6-1", "6"], ["6-2", "6"], ["7a", "7"], ["7b", "7"],
    ["9A", "9"], ["9B", "9"], ["12-1", "12"], ["12-2", "12"]]);
    // Init segmentsSteps
    this.segmentsSteps = new Map<number, string>();
    // Init segmentsVisual
    this.segmentsVisual = [];

    this.route = this.sharedService.getRoute();
    this.sharedService.setRoute(undefined);
    if (!this.route) {

      this.route = {
        id: 13352,
        name: "ruta1",
        origin: { id: 13354, name: "2, Plaza de Ortega y Gasset, Coslada, Área metropolitana de Madrid y Corredor del Henares, Comunidad de Madrid, 28821, España", longitude: -3.5655006, latitude: 40.4241342 },
        destination: { id: 13353, name: "Sol, Puerta del Sol, Barrio de los Austrias, Sol, Centro, Madrid, Área metropolitana de Madrid y Corredor del Henares, Comunidad de Madrid, 28013, España", longitude: -3.7033901, latitude: 40.416938 },
        maxDistance: 0.8,
        transports: ["Metro", "Bus", "Cercanías", "BiciMAD"],
        preferences: { "C_Instalaciones culturales": 4, "C_Parques y jardines": 5, "C_Escuelas de cocina y catas de vinos y aceites": 1, "C_Empresas de guías Turísticas": 0, "C_Edificios y monumentos": 3, "C_Centros de ocio": 0, "D_Deportes": 1, "T_Tiendas": 2, "R_Restauración": 2 },
        date: new Date("2022-04-01"),
        distance: 18.759999999999998,
        duration: 138,
        points: [{ id: 13354, name: "2, Plaza de Ortega y Gasset, Coslada, Área metropolitana de Madrid y Corredor del Henares, Comunidad de Madrid, 28821, España", longitude: -3.5655006, latitude: 40.4241342 }, { id: 4143, name: "Barrio del Puerto", longitude: -3.56918847026566, latitude: 40.422496870096 }, { id: 3602, name: "Estadio Metropolitano", longitude: -3.60015365421252, latitude: 40.4333934840999 }, { id: 4147, name: "Las Musas", longitude: -3.60787951427632, latitude: 40.4329881279398 }, { id: 3903, name: "San Blas", longitude: -3.61546907625776, latitude: 40.4279919067674 }, { id: 3795, name: "Simancas", longitude: -3.62572167294121, latitude: 40.4279923730252 }, { id: 8866, name: "Emilio Muñoz-Alfonso Gómez", longitude: -3.62502750152115, latitude: 40.4332475837852 }, { id: 8871, name: "Emilio Muñoz-Miguel Yuste", longitude: -3.62307930862, latitude: 40.434222047573 }, { id: 6637, name: "San Romualdo-Albasanz", longitude: -3.62153212646944, latitude: 40.4388655081748 }, { id: 6676, name: "Alcalá-25 de Septiembre", longitude: -3.62313746627467, latitude: 40.4416136447194 }, { id: 4000, name: "Suanzes", longitude: -3.62683974417714, latitude: 40.4408512430777 }, { id: 3786, name: "Ciudad Lineal", longitude: -3.6381575883455, latitude: 40.4380484084201 }, { id: 3778, name: "Pueblo Nuevo", longitude: -3.64282293725217, latitude: 40.4356585154991 }, { id: 3880, name: "Quintana", longitude: -3.64736224209832, latitude: 40.4335849416495 }, { id: 3919, name: "El Carmen", longitude: -3.65757254725966, latitude: 40.4318932920946 }, { id: 3876, name: "Ventas", longitude: -3.66360584172735, latitude: 40.4308848031949 }, { id: 3580, name: "Manuel Becerra", longitude: -3.66920518071164, latitude: 40.4279044798375 }, { id: 4144, name: "Goya", longitude: -3.67591017618596, latitude: 40.4245483896706 }, { id: 3863, name: "Príncipe de Vergara", longitude: -3.68012268104369, latitude: 40.4229448617607 }, { id: 4135, name: "Retiro", longitude: -3.68624471917784, latitude: 40.4203067175233 }, { id: 3545, name: "Banco de España", longitude: -3.69496510558138, latitude: 40.4192197861148 }, { id: 3978, name: "Sevilla", longitude: -3.69925113804034, latitude: 40.4180507481241 }, { id: 13353, name: "Sol, Puerta del Sol, Barrio de los Austrias, Sol, Centro, Madrid, Área metropolitana de Madrid y Corredor del Henares, Comunidad de Madrid, 28013, España", longitude: -3.7033901, latitude: 40.416938 }],
        segments: [
          { id: 13355, source: 0, target: 1, distance: 0.51, duration: 6, transportMode: "A pie", steps: ["0-1:Camina hacia el noroeste en Plaza de Ortega y Gasset", "1-7:¡Gire a la izquierda a Calle Doctor Barraquer!", "7-11:¡Gire a la derecha a Calle Doctor Fleming!", "11-12:¡Gire a la izquierda a Calle Jaén!", "12-14:¡Gire a la derecha!", "14-15:¡Gire a la izquierda!", "15-18:¡Gire ligeramente a la derecha!", "18-22:¡Gire a la izquierda!", "22-23:¡Gire a la derecha!", "23-24:¡Gire a la izquierda!", "24-24:Llegar a su destino, a la derecha"], "polyline": [[40.424189, -3.565483], [40.424356, -3.565705], [40.424331, -3.565741], [40.424161, -3.565968], [40.424143, -3.565984], [40.424127, -3.565989], [40.423911, -3.565952], [40.423834, -3.565939], [40.423773, -3.566742], [40.423755, -3.566993], [40.42375, -3.567113], [40.423681, -3.567938], [40.423602, -3.567933], [40.423592, -3.568054], [40.423587, -3.56814], [40.422728, -3.568038], [40.422688, -3.568057], [40.422667, -3.568067], [40.422698, -3.568203], [40.422627, -3.568244], [40.422569, -3.568273], [40.422526, -3.568294], [40.422491, -3.568312], [40.422651, -3.568941], [40.422456, -3.569024]], line: null, destination: null, color: "#2D2E2D" },
          { id: 13356, source: 1, target: 2, distance: 3.66, duration: 14, transportMode: "Metro", steps: [], "polyline": [[40.4236951464902, -3.56169133961854], [40.422935351589, -3.56238748600581], [40.4224610289937, -3.56294863273017], [40.4221330735816, -3.56377173529274], [40.4220160706098, -3.5648596870991], [40.4221484615424, -3.56634436450983], [40.4223045358004, -3.56755153507887], [40.4226119848456, -3.5688490093316], [40.4226119848456, -3.5688490093316], [40.4228257467912, -3.56964986528915], [40.4232648570085, -3.5712540810367], [40.4235865040925, -3.57239417931484], [40.4292890343272, -3.59550784938839], [40.4323929426621, -3.59904982451004], [40.4331690544744, -3.60007448596855], [40.4332019756963, -3.60012301215212]], line: "7b", destination: "Estadio Metropolitano", color: "#EE7518" },
          { id: 13357, source: 2, target: 5, distance: 2.77, duration: 12, transportMode: "Metro", steps: [], "polyline": [[40.4333761539895, -3.59994126191949], [40.4343095314279, -3.60119618211367], [40.4347580338317, -3.60204242893135], [40.4349703642445, -3.6024654525224], [40.4352905199842, -3.6027802560612], [40.4360626584444, -3.60327066983968], [40.4363940796216, -3.6037103682277], [40.4365104125275, -3.60425732756908], [40.4365190736627, -3.60488132013441], [40.4363396160496, -3.60547578570549], [40.4348161275635, -3.60655284630454], [40.4329550703401, -3.60787176777965], [40.4329550703401, -3.60787176777965], [40.4328060398872, -3.60797646908907], [40.4327159782652, -3.6080396776384], [40.4325360341885, -3.60816609584934], [40.4324460613794, -3.6082291844419], [40.4323921693128, -3.6082670178288], [40.4322845656795, -3.60834244553951], [40.4321769589416, -3.60841811113538], [40.4321231566311, -3.6084558247774], [40.4320693539495, -3.6084937776867], [40.4320155519007, -3.60853160792925], [40.4319618390186, -3.60856944009479], [40.4319080363057, -3.60860739164506], [40.431854321597, -3.60864522367456], [40.4317557617105, -3.6087140128402], [40.4316902931416, -3.60876034629674], [40.4316575556457, -3.60878386488203], [40.4316250007214, -3.60880727073219], [40.4315598875052, -3.60885454802327], [40.4315273280075, -3.60887830627297], [40.4314948615735, -3.60890218323503], [40.4313845959651, -3.60898689867625], [40.431348138446, -3.60901557442221], [40.4313117688201, -3.60904483687026], [40.4312755778248, -3.60907422115184], [40.4312395651311, -3.60910396069656], [40.4312036412799, -3.60913393562274], [40.4311664441941, -3.60916600935031], [40.4310970293381, -3.60922587489052], [40.4310362046614, -3.60927991248369], [40.4309759170157, -3.60933478244853], [40.4309161613176, -3.60939059438025], [40.4308567642648, -3.6094472394291], [40.4307979931011, -3.60950494990074], [40.4307397578018, -3.60956337129806], [40.4306820564884, -3.60962285964424], [40.4306248904151, -3.60968317680311], [40.4305681715566, -3.60974444340978], [40.430512169916, -3.60980653929227], [40.4304567014308, -3.60986934607276], [40.4304335882664, -3.60989590152659], [40.4304106567394, -3.60992269203298], [40.4303879024034, -3.6099493650495], [40.4303199949104, -3.61003080782209], [40.4302976004866, -3.61005807348685], [40.4302752020972, -3.61008557724268], [40.4302529850532, -3.61011320051271], [40.4302307667584, -3.61014105954023], [40.4302088166537, -3.6101687995432], [40.4301837832673, -3.61020087843039], [40.4301098471601, -3.61029794247292], [40.43008553374, -3.61033049934717], [40.4300613049449, -3.61036340710581], [40.4300372556781, -3.61039643671509], [40.4299657379675, -3.61049647070715], [40.4299422272527, -3.61053021127166], [40.4299203471402, -3.61056208027315], [40.429876946883, -3.61062605843477], [40.4297919381016, -3.61075556096818], [40.4297709546952, -3.61078838343777], [40.4297500607491, -3.6108213234101], [40.4296678232346, -3.61095486005705], [40.4296474641576, -3.61098886462135], [40.4296272849652, -3.61102275290086], [40.4296071939861, -3.61105699445673], [40.4295872843416, -3.61109135670489], [40.4295674626813, -3.61112560419481], [40.429508896194, -3.61122964324038], [40.4294896130721, -3.61126460287901], [40.4294685052331, -3.61130355194977], [40.4294269206806, -3.6113816903389], [40.4294063532448, -3.61142099908607], [40.4293657545669, -3.61150009057517], [40.4293458161071, -3.61153987533681], [40.4293259646585, -3.61157989900476], [40.4293063837506, -3.6116200394552], [40.4292868904772, -3.61166030092597], [40.4292676692563, -3.61170056365955], [40.4292526368981, -3.61173237612057], [40.4292376952412, -3.61176407149762], [40.4292083465966, -3.61182805651333], [40.4291938549913, -3.61185999288938], [40.4291794498024, -3.61189228135195], [40.4291651353085, -3.61192445391011], [40.429151000354, -3.6119567459736], [40.4291370461041, -3.61198927780253], [40.4291229996992, -3.61202168735434], [40.4291093141834, -3.61205433594737], [40.4290934391219, -3.61209215307958], [40.4290777424, -3.61212997534773], [40.4290621360536, -3.61216791159351], [40.4290467116626, -3.61220585065063], [40.4290312839325, -3.61224390755148], [40.4290161291572, -3.61228196573146], [40.4290010595847, -3.61232026398646], [40.4289860828072, -3.61235855952928], [40.4289711053738, -3.61239697647715], [40.4289563975805, -3.61243551020844], [40.428941869658, -3.61247393002133], [40.4289235973355, -3.61252174478215], [40.4288872381904, -3.61261737944609], [40.4288691459813, -3.61266519576384], [40.4288510549108, -3.61271313349407], [40.4288330542077, -3.61276118519414], [40.4288150504813, -3.61280912366579], [40.4287971404434, -3.6128570594256], [40.4287793189337, -3.61290511621237], [40.4287614980416, -3.61295305273067], [40.4287437638758, -3.61300111025975], [40.4287078494968, -3.61309757250611], [40.4286720215081, -3.61319403779224], [40.4286361069692, -3.61329049983192], [40.4286002791148, -3.61338707926818], [40.4285643635025, -3.61348354345062], [40.4283494042376, -3.61406231710279], [40.4283369737844, -3.61409568602226], [40.4283245466504, -3.6141289370695], [40.4283121161781, -3.61416230596422], [40.4282872591787, -3.6142288044359], [40.428274921192, -3.61426205624521], [40.4282624907003, -3.614295421554], [40.4282525218931, -3.61432209541498], [40.4282500635093, -3.61432867252725], [40.4282127764865, -3.61442842296613], [40.4281780445766, -3.61452253665961], [40.4281434006009, -3.61461653316692], [40.4281086664568, -3.61471052993565], [40.4280738430578, -3.61480452461595], [40.4280391120914, -3.61489840333036], [40.4279343719277, -3.61518003154952], [40.4278993685983, -3.6152739073946], [40.4278993685983, -3.6152739073946], [40.4278293629737, -3.61546142184466], [40.4277162486868, -3.61575923945269], [40.4276047489004, -3.61605825086136], [40.4275439686212, -3.61622168068955], [40.4275378464056, -3.616238012525], [40.4275318133729, -3.61625434517148], [40.4275256884689, -3.61627067343982], [40.427513623293, -3.61630333872628], [40.4275075017132, -3.61631954912744], [40.4275014695699, -3.61633588176741], [40.4274953464374, -3.61635221357384], [40.4274832794557, -3.61638487527789], [40.4274771563163, -3.61640120707541], [40.4274711241741, -3.61641753734298], [40.4274650025595, -3.61643375125992], [40.4274529373567, -3.61646641295093], [40.4274468142058, -3.61648274473361], [40.4274407793434, -3.61649907614059], [40.4274346571014, -3.61651540556789], [40.427422591863, -3.61654806958707], [40.4274164696141, -3.61656439900546], [40.4274104371644, -3.61658061371022], [40.4274044049845, -3.61659694630302], [40.4273982800324, -3.616613274509], [40.4273862147603, -3.61664593967166], [40.4273800915843, -3.61666227142167], [40.4273680263173, -3.61669493303015], [40.4273619022335, -3.61671126476302], [40.4273558691533, -3.61672759378753], [40.4273498375816, -3.61674380847116], [40.4273437143919, -3.61676014020336], [40.4273316490974, -3.61679280177648], [40.4273255268016, -3.61680913350801], [40.4273134587908, -3.61684179503875], [40.4273073364881, -3.61685812676137], [40.4272952711662, -3.61689078829911], [40.4272891488566, -3.61690712001282], [40.427283116378, -3.61692333111943], [40.4272710492171, -3.61695599615365], [40.4272649260164, -3.61697232431078], [40.4272528606436, -3.61700498934377], [40.427246738318, -3.61702132103669], [40.4272286380013, -3.61707031499817], [40.4272225156855, -3.61708664314276], [40.4272104502805, -3.61711930813449], [40.427204417766, -3.61713552038178], [40.4271982954221, -3.61715185205099], [40.4271801950505, -3.61720084594179], [40.4271740718029, -3.61721717641205], [40.4271680401756, -3.61723338864997], [40.4271620070032, -3.6172497211167], [40.4271558846433, -3.61726605276512], [40.4271438174051, -3.61729871413913], [40.4271377848531, -3.61731492871179], [40.4271316625029, -3.61733125681189], [40.4271195970292, -3.61736392171528], [40.4271134737713, -3.61738024979823], [40.4271074394062, -3.61739646433975], [40.4271014071118, -3.61741279678525], [40.4270952847479, -3.61742912486755], [40.427089251548, -3.61744545729892], [40.4270832198764, -3.61746167185341], [40.4270770965984, -3.61747800109738], [40.4270650292882, -3.61751066475245], [40.427058906633, -3.61752687610539], [40.4270528743204, -3.61754320852734], [40.4270467519193, -3.61755954012235], [40.4270407187074, -3.61757587135132], [40.4270346870302, -3.61759208352469], [40.4270285637214, -3.61760841510257], [40.4270225286946, -3.61762474748505], [40.427016406301, -3.61764107552876], [40.4270103737012, -3.61765729003978], [40.4270042512841, -3.61767362161401], [40.4269982189697, -3.61768995047295], [40.4269920956472, -3.617706282033], [40.4269860612366, -3.61772249651578], [40.4269799388292, -3.61773882454167], [40.4269739055859, -3.61775515691705], [40.4269678738711, -3.61777137141575], [40.426961750556, -3.6177876994245], [40.4269557182067, -3.61780403179928], [40.426949596399, -3.61782024546485], [40.4269435613551, -3.61783657545137], [40.4269375287281, -3.61785278992715], [40.4269313161975, -3.61786912064139], [40.4269252829548, -3.61788544945672], [40.4269191605057, -3.61790178098936], [40.4269131281404, -3.61791811334349], [40.4269070036331, -3.61793432342716], [40.4269009703623, -3.61795065576714], [40.426894847904, -3.61796698728791], [40.4268888152778, -3.61798319820372], [40.426882782901, -3.61799953054312], [40.4268765703498, -3.61801586123041], [40.4268705359087, -3.61803207329972], [40.4268644125444, -3.61804840361857], [40.4268583807888, -3.61806461806438], [40.4268523475123, -3.61808094802314], [40.4268461349497, -3.61809727869547], [40.4268401031872, -3.61811349313246], [40.4268340699102, -3.61812982190356], [40.4268278546381, -3.61814615254216], [40.4268218228688, -3.61816236697032], [40.4268157003997, -3.61817869491601], [40.4268097584415, -3.6181947922732], [40.4268034538857, -3.61821147574476], [40.4267972367173, -3.6182281588345], [40.4267909321756, -3.61824483876334], [40.4267847177051, -3.61826152187161], [40.4267784104371, -3.61827820530592], [40.4267721052453, -3.61829500546462], [40.426765981484, -3.61831157150692], [40.4267596769115, -3.61832825495659], [40.4267533699107, -3.61834505508939], [40.4267098648625, -3.61846183661871], [40.4267036470276, -3.61847863754339], [40.4266787863007, -3.61854536858064], [40.4266727516828, -3.61856193657285], [40.4266664483358, -3.61857838421293], [40.4266602338174, -3.61859506725926], [40.4266540178682, -3.61861151215731], [40.426647983511, -3.61862819802709], [40.4266419495184, -3.61864464694402], [40.4266359145256, -3.61866145068918], [40.4266298801675, -3.61867813537113], [40.4266112081262, -3.61873299280017], [40.4265841171811, -3.61881257765822], [40.4265786202543, -3.61882950301363], [40.4265731235949, -3.61884654625577], [40.426567809538, -3.61886347328178], [40.426562310698, -3.61888075463022], [40.4265263538696, -3.61900055067849], [40.4265214867826, -3.61901795568398], [40.4265165317827, -3.61903512174933], [40.4265117527241, -3.61905240613334], [40.4265067917622, -3.61907051641325], [40.4264752169292, -3.61919683740343], [40.4264471472064, -3.61932436811513], [40.4264433536314, -3.61934284154741], [40.4264163486397, -3.61949054407915], [40.4264132753646, -3.61950925987605], [40.4263970062114, -3.61962015754145], [40.4263876000804, -3.61969457798096], [40.4263722967345, -3.61984391666226], [40.4263628552322, -3.61997480443118], [40.4263608527512, -3.62001239188941], [40.426355273802, -3.62017961946143], [40.4263560774186, -3.6203660068201], [40.4263621225974, -3.62051589749034], [40.4263750004395, -3.62068518087488], [40.4263940969542, -3.62085346288226], [40.4264191568034, -3.62101897055058], [40.4264499105641, -3.62118087741319], [40.426473481556, -3.62128789739981], [40.4264907598397, -3.62135867181088], [40.4265345895547, -3.62151810349323], [40.4265892356806, -3.62169355090489], [40.4265952677835, -3.62171104076466], [40.4266428173161, -3.6218489468019], [40.4268162162266, -3.62232362379092], [40.4268524382759, -3.6224229819842], [40.4268583851887, -3.62243954105935], [40.4268946098398, -3.62253889940081], [40.4269005567357, -3.62255545849635], [40.4269186685744, -3.62260513712193], [40.4269246154544, -3.62262169740792], [40.4269366911873, -3.62265481848795], [40.4269426380791, -3.62267137524621], [40.4269547110951, -3.62270449631889], [40.4269606579606, -3.62272105662233], [40.4269666967306, -3.62273761423972], [40.4269727334116, -3.62275405748972], [40.4269786802763, -3.62277061662305], [40.4269847172183, -3.62278717776906], [40.4269907566138, -3.62280361751628], [40.426996793551, -3.62282017866815], [40.4270027395053, -3.62283673780481], [40.4270087770728, -3.62285318108062], [40.4270148158237, -3.62286973872144], [40.4270207626717, -3.62288629787513], [40.427026800232, -3.62290274115968], [40.4270388731936, -3.62293585995672], [40.4270448224689, -3.62295230125669], [40.4270568954161, -3.6229854200713], [40.4270628428762, -3.62300186254213], [40.4270749184989, -3.62303498375688], [40.4270809560569, -3.62305142353125], [40.4270869019714, -3.62306798388741], [40.4270929406783, -3.62308454392394], [40.4270989782293, -3.62310098370706], [40.4271049250374, -3.62311754408026], [40.4271109610283, -3.62313410527945], [40.4271169985593, -3.62315054742896], [40.4271230372671, -3.6231671051225], [40.4271289840656, -3.62318366550732], [40.4271350215832, -3.62320010884442], [40.4271410575685, -3.62321666887943], [40.4271470070815, -3.62323322576144], [40.427153043691, -3.62324966909897], [40.4271651165393, -3.62328279037664], [40.4271710666782, -3.62329922938809], [40.4271831395121, -3.62333235068334], [40.427189086935, -3.62334879085735], [40.4272011624571, -3.62338191219509], [40.4272071990453, -3.62339835555889], [40.4272131458294, -3.62341491244793], [40.4272191826844, -3.62343147252933], [40.427225221968, -3.62344791592683], [40.4272311687322, -3.62346447518224], [40.4272372046919, -3.62348103290645], [40.4272432421666, -3.62349747629607], [40.427249280805, -3.62351403758757], [40.4272552275724, -3.62353059449696], [40.4272612641455, -3.62354703670819], [40.427267300975, -3.62356359799184], [40.427273247716, -3.6235801584464], [40.4272792869974, -3.62359659833369], [40.427285323826, -3.6236131584473], [40.4272912709308, -3.62362948313746], [40.4272955308408, -3.623641428022], [40.4272997910146, -3.62365349079878], [40.4273041409891, -3.62366544005492], [40.4273084008953, -3.62367738494397], [40.4273128397005, -3.62368956726373], [40.4273215396597, -3.62371346225027], [40.4273259821707, -3.62372529094399], [40.4273303321377, -3.62373724020932], [40.4273347715725, -3.62374930465443], [40.427339212914, -3.62376101545367], [40.4273426719415, -3.62377095003256], [40.4273464023855, -3.6237810061873], [40.427350042749, -3.62379106033201], [40.4273535925023, -3.623800876685], [40.4273571436662, -3.62381093236548], [40.4273608714167, -3.62382098614192], [40.4273645126839, -3.6238310391204], [40.4273681509828, -3.62384097418414], [40.427375340434, -3.62386096611354], [40.4274110300603, -3.62395890755044], [40.4274169804735, -3.62397511090685], [40.4274228383415, -3.62399143483597], [40.427434732088, -3.62402431658837], [40.4274763686063, -3.62413858297546], [40.4274823198885, -3.6241547875503], [40.4274881777308, -3.62417111151056], [40.4274941241258, -3.62418755300205], [40.427500072062, -3.62420387544316], [40.4275060193531, -3.62422031694873], [40.4275536053924, -3.6243509060589], [40.4275595539484, -3.62436710946687], [40.4275654117603, -3.62438343346392], [40.4275713590192, -3.62439987617979], [40.4275832566241, -3.62443252233453], [40.4275886082494, -3.62444732089597]], line: "7a", destination: "Pitis", color: "#EE7518" },
          { id: 13358, source: 5, target: 6, distance: 0.79, duration: 9, transportMode: "A pie", steps: ["0-3:Camina hacia el norte en Calle Castillo de Uclés", "3-5:¡Gire a la derecha a Calle Castillo de Madrigal de las Altas Torres!", "5-6:¡Gire a la derecha a Calle Castillo de Madrigal de las Altas Torres!", "6-10:¡Gire a la izquierda a Calle Zaratán!", "10-11:¡Gire a la derecha a Calle Zaratán!", "11-21:¡Gire a la izquierda a Calle Zaldívar!", "21-22:¡Gire ligeramente a la izquierda a Calle Zaldívar!", "22-28:¡Gire ligeramente a la derecha a Calle Zaldívar!", "28-33:¡Gire a la derecha a Calle de Emilio Muñoz!", "33-33:Llegar a Calle de Emilio Muñoz, a la derecha"], "polyline": [[40.428011, -3.625852], [40.428024, -3.625849], [40.428068, -3.625901], [40.428129, -3.626102], [40.428184, -3.626054], [40.428256, -3.625992], [40.428199, -3.625756], [40.428297, -3.625729], [40.428787, -3.625591], [40.429283, -3.625464], [40.429364, -3.625468], [40.429654, -3.624841], [40.429705, -3.624877], [40.430392, -3.625356], [40.430487, -3.625422], [40.430769, -3.625621], [40.430802, -3.625642], [40.430851, -3.625661], [40.430893, -3.625692], [40.431121, -3.625866], [40.431315, -3.626011], [40.431431, -3.626097], [40.431432, -3.626099], [40.431703, -3.626295], [40.431895, -3.626428], [40.431977, -3.626486], [40.432073, -3.626557], [40.432356, -3.626767], [40.432444, -3.626833], [40.432483, -3.62675], [40.433064, -3.625537], [40.433128, -3.625405], [40.433269, -3.625113], [40.433292, -3.625065]], line: null, destination: null, color: "#2D2E2D" },
          { id: 13359, source: 6, target: 7, distance: 0.21, duration: 14, transportMode: "Bus", steps: [], "polyline": [[40.433292, -3.625065], [40.433388, -3.624864], [40.433606, -3.624419], [40.433779, -3.624079], [40.433826, -3.623989], [40.434235, -3.623159], [40.434282, -3.623071], [40.43424, -3.623039]], line: "28", destination: "Barrio Canillejas", color: "#0178BC" },
          { id: 13360, source: 7, target: 8, distance: 0.69, duration: 8, transportMode: "A pie", steps: ["0-1:Camina hacia el noroeste en Calle Castillo de Uclés", "1-4:¡Gire a la derecha a Calle de Emilio Muñoz!", "4-8:¡Gire a la izquierda a Calle de Miguel Yuste!", "8-13:¡Gire a la derecha a Calle de Julián Camarillo!", "13-14:¡Gire a la izquierda a Calle de San Romualdo!", "14-16:¡Gire a la derecha!", "16-16:Llegar a su destino, es recto"], "polyline": [[40.43424, -3.623039], [40.434282, -3.623071], [40.434437, -3.622787], [40.434501, -3.622675], [40.434575, -3.622521], [40.435245, -3.622872], [40.435582, -3.623047], [40.436093, -3.623263], [40.436256, -3.623341], [40.436336, -3.623133], [40.436655, -3.622327], [40.437111, -3.621155], [40.437157, -3.621025], [40.437235, -3.620853], [40.43738, -3.620923], [40.437412, -3.620853], [40.438866, -3.621529]], line: null, destination: null, color: "#2D2E2D" },
          { id: 13361, source: 8, target: 9, distance: 0.35, duration: 31, transportMode: "Bus", steps: [], "polyline": [[40.438847, -3.621601], [40.438907, -3.621629], [40.439046, -3.621693], [40.438993, -3.62185], [40.439137, -3.621922], [40.440057, -3.622386], [40.441066, -3.62301], [40.441124, -3.623046], [40.441342, -3.623154], [40.441597, -3.623202], [40.44161, -3.623204]], line: "105", destination: "Barajas", color: "#0178BC" }, { id: 13362, source: 9, target: 10, distance: 0.5, duration: 6, transportMode: "A pie", steps: ["0-18:Camina hacia el sur", "18-27:¡Gire a la izquierda!", "27-31:¡Gire a la izquierda!", "31-32:¡Gire a la derecha!", "32-34:¡Gire a la derecha!", "34-35:¡Gire a la izquierda!", "35-35:Llegar a su destino, a la izquierda"], "polyline": [[40.441617, -3.623085], [40.4415, -3.623071], [40.441492, -3.623134], [40.441485, -3.623186], [40.441478, -3.623239], [40.441471, -3.623294], [40.441454, -3.623347], [40.441439, -3.623396], [40.441421, -3.62345], [40.441404, -3.623503], [40.441604, -3.623631], [40.441638, -3.623686], [40.441645, -3.623751], [40.441632, -3.623831], [40.441652, -3.62384], [40.441686, -3.623855], [40.441761, -3.623889], [40.441805, -3.62391], [40.441828, -3.62392], [40.441799, -3.624018], [40.441373, -3.625586], [40.441175, -3.626302], [40.441055, -3.626711], [40.441015, -3.626822], [40.44099, -3.626913], [40.440951, -3.627052], [40.440879, -3.627016], [40.440874, -3.627014], [40.440915, -3.626871], [40.440938, -3.626789], [40.440993, -3.626588], [40.441007, -3.62654], [40.440925, -3.626501], [40.440889, -3.626627], [40.440941, -3.626653], [40.440885, -3.626856]], line: null, destination: null, color: "#2D2E2D" }, { id: 13363, source: 10, target: 15, distance: 4.21, duration: 17, transportMode: "Metro", steps: [], "polyline": [[40.4432957930912, -3.61798536041606], [40.443291650127, -3.61800064215269], [40.4432870538084, -3.61801781464927], [40.443111502743, -3.6186528396647], [40.4431021275696, -3.61868741981199], [40.4430974416885, -3.61870447465544], [40.4430927560746, -3.61872164741485], [40.4430879803787, -3.61873881816672], [40.4430645486426, -3.61882468424058], [40.4430598623861, -3.61884197371403], [40.4430457993412, -3.61889396471316], [40.4430223643401, -3.61898041904899], [40.4430176786917, -3.61899759059059], [40.442980183807, -3.61913591550715], [40.4429754954332, -3.61915308700217], [40.442970719023, -3.61917037914015], [40.4429660311764, -3.61918778764568], [40.4429613448658, -3.61920507706806], [40.4429566598096, -3.6192221318474], [40.4429518806993, -3.61923942159255], [40.4429471937494, -3.61925682891749], [40.4429425065088, -3.61927412185916], [40.4429378208108, -3.61929129453865], [40.4429330416901, -3.61930858427398], [40.4429283553616, -3.61932587367932], [40.4429235795701, -3.61934304552471], [40.442918891685, -3.61936045636399], [40.4429142059742, -3.61937762903134], [40.442909426847, -3.61939491757525], [40.4429047404994, -3.6194122081475], [40.4428999646951, -3.61942937998062], [40.4428952783486, -3.6194466693689], [40.4428905018948, -3.61946396146506], [40.4428858128343, -3.61948125200274], [40.4428810354935, -3.61949854054841], [40.4428762596764, -3.61951571236925], [40.4428715733108, -3.61953300292441], [40.4428667941605, -3.61955029144615], [40.4428574226677, -3.61958463908311], [40.4428105633344, -3.61975518498269], [40.4428058775653, -3.61977235759441], [40.4428012825117, -3.61978941312156], [40.442796597101, -3.61980634990107], [40.4427591095567, -3.61994278969398], [40.4427544228653, -3.6199599610919], [40.4427498277841, -3.61997701659296], [40.442745143247, -3.6199939533545], [40.4427217128578, -3.62007922663231], [40.4427170270281, -3.62009640155657], [40.4427123391385, -3.62011345618597], [40.4427076533165, -3.62013062874723], [40.4427030573095, -3.62014768421629], [40.4426983727475, -3.62016462095397], [40.4426655718177, -3.62028400219593], [40.442660883268, -3.62030117470832], [40.442656288143, -3.62031822898285], [40.4426516035499, -3.62033516687577], [40.4426234876694, -3.62043749570196], [40.4426188017995, -3.62045466821757], [40.4426142057449, -3.62047172364156], [40.442609519334, -3.62048866031736], [40.4426048331885, -3.62050571490828], [40.4426001473085, -3.62052288741428], [40.4425814026981, -3.62059110456526], [40.4425767167865, -3.62060828059651], [40.4425721207093, -3.62062533599916], [40.4425674360777, -3.62064227267005], [40.44254400612, -3.62072754432208], [40.4425393202073, -3.62074471679684], [40.4425347241101, -3.62076177218051], [40.4425300367561, -3.62077870880746], [40.4425066066983, -3.62086398036374], [40.4425019207527, -3.62088115517746], [40.4424973252688, -3.62089809263315], [40.4424922735617, -3.62091643968757], [40.4424873083277, -3.62093478871408], [40.4424823464204, -3.62095302103283], [40.4424772926417, -3.62097124896603], [40.4424673697136, -3.62100771359819], [40.4424623143731, -3.62102606296109], [40.4424573533713, -3.62104429173724], [40.4424522986584, -3.62106252318567], [40.4424473369985, -3.62108087340256], [40.4424422850015, -3.62109910133309], [40.4424323593307, -3.62113556590222], [40.4424229877484, -3.62116967490842], [40.4424182990741, -3.62118684611699], [40.4424137038129, -3.62120390144753], [40.4424090181961, -3.62122083802925], [40.4423902740705, -3.62128905597596], [40.4423856785272, -3.62130599337518], [40.4423575626865, -3.62140832257146], [40.44235287704, -3.62142525912457], [40.4423294465079, -3.6215105302272], [40.4423247617474, -3.62152746677428], [40.4423060165409, -3.62159568454033], [40.442301331768, -3.62161262107549], [40.4422966454576, -3.62162967550862], [40.4422918681581, -3.62164672910118], [40.4422871818428, -3.62166378352948], [40.4422824970599, -3.62168072005508], [40.4422731253049, -3.62171483126622], [40.442268348627, -3.62173176693805], [40.4422542914377, -3.62178293019645], [40.4422495165517, -3.62179986587523], [40.4422354566362, -3.62185102790084], [40.4422306817339, -3.62186796474905], [40.4422213081412, -3.62190207235352], [40.4422165332378, -3.6219190080154], [40.4422118475169, -3.62193594449683], [40.4422070713398, -3.62195311597087], [40.4422023838121, -3.62197005243089], [40.4421976088988, -3.6219869880831], [40.4421929228, -3.62200416038017], [40.4421882370666, -3.62202109684963], [40.4421834621459, -3.62203803249459], [40.4421787733369, -3.62205520475952], [40.4421739984112, -3.62207214039965], [40.4421693135688, -3.62208907686782], [40.4421645379909, -3.62210613276971], [40.4421504779343, -3.62215729584465], [40.4421458831653, -3.62217423313145], [40.4421411967725, -3.62219128748536], [40.4421366019986, -3.62220822476747], [40.4421319165017, -3.62222527912494], [40.4421273190202, -3.62224221637741], [40.4421226326175, -3.62225927072181], [40.4421180378336, -3.62227620799452], [40.4421133523268, -3.62229326234245], [40.4421087566371, -3.62231019960215], [40.4421040711253, -3.62232725394533], [40.4420994736289, -3.6223441911837], [40.4420947872112, -3.62236124551382], [40.4420901924125, -3.62237818277242], [40.4420855068907, -3.62239523710607], [40.4420809111862, -3.62241217435167], [40.4420762250309, -3.62242934540974], [40.4420716293214, -3.62244628265061], [40.4420669417155, -3.62246322022067], [40.4420622561876, -3.62248027336333], [40.4420576613715, -3.62249721060546], [40.4420529749314, -3.62251426491413], [40.4420483801104, -3.62253120215157], [40.4420436945661, -3.62254825646379], [40.4420390970376, -3.62256519367158], [40.4420344105684, -3.62258225150797], [40.4420298157375, -3.62259918873601], [40.4420251292824, -3.62261624303039], [40.4420205344465, -3.62263318025372], [40.4420158488873, -3.62265023455166], [40.4420111612581, -3.62266717091413], [40.4420065648788, -3.62268422603022], [40.4420018799472, -3.62270116241287], [40.4419972844638, -3.62271821753256], [40.4419925986264, -3.62273515390216], [40.441988003138, -3.62275220901713], [40.441983315494, -3.62276914536536], [40.4419787191061, -3.62278619928821], [40.4419740341533, -3.62280313683572], [40.4419693485755, -3.62282018993074], [40.441964752809, -3.62283712711754], [40.4419600672199, -3.62285418138688], [40.4419554714484, -3.62287111856898], [40.4419507840526, -3.62288817281692], [40.4419461882762, -3.62290510999433], [40.4419415026771, -3.62292216425414], [40.44193681681, -3.62293910059524], [40.4419322212917, -3.62295615568189], [40.4419275363205, -3.62297309202658], [40.4419229374592, -3.62299026499152], [40.4419182515821, -3.62300720132313], [40.4419136566893, -3.62302413849238], [40.4419089710727, -3.62304119273552], [40.4419042851882, -3.62305812905999], [40.4418996896525, -3.62307518413012], [40.4418950019614, -3.62309212043323], [40.441890405507, -3.62310917784847], [40.4418857205135, -3.62312611417177], [40.441881034882, -3.6231431684006], [40.4418764390685, -3.62316010554271], [40.4418717534319, -3.62317715976678], [40.4418671558117, -3.62319409688755], [40.4418624701702, -3.62321115110685], [40.441857784261, -3.62322808740758], [40.4418531887003, -3.6232451424541], [40.441848503687, -3.62326207875841], [40.4418439072204, -3.62327913379189], [40.4418392194995, -3.62329607006649], [40.4418345338431, -3.62331312427148], [40.4418299380048, -3.62333006139007], [40.4418252523433, -3.62334711559029], [40.4418206574009, -3.62336405271251], [40.4418159708336, -3.62338110689966], [40.4418112830979, -3.62339804315999], [40.4418066875123, -3.6234150981829], [40.4418020024742, -3.62343203446347], [40.4417974059827, -3.62344908947333], [40.4417833462358, -3.62350025199182], [40.4417786590189, -3.62351742288848], [40.4417740633967, -3.62353448143205], [40.4417693783412, -3.62355141769594], [40.4417646904807, -3.62356870649309], [40.4417600948701, -3.62358576149232], [40.4417554071045, -3.62360269772409], [40.4417507214031, -3.6236197518861], [40.4417460341622, -3.62363692394504], [40.4417414385414, -3.6236539789348], [40.4417367525677, -3.62367091517368], [40.4417273771738, -3.62370525808736], [40.441722781543, -3.62372231306764], [40.4417180955593, -3.62373924929698], [40.4417134098378, -3.62375630343986], [40.4417087234649, -3.62377347784608], [40.4417041262871, -3.62379065071612], [40.4416994384917, -3.62380758691927], [40.4416947527601, -3.62382464105258], [40.4416900663898, -3.62384181309103], [40.4416854698382, -3.62385886804403], [40.4416807847355, -3.62387580426264], [40.4416760977276, -3.62389309302234], [40.4416714993668, -3.62391014795156], [40.4416668133557, -3.62392708415469], [40.4416621276066, -3.62394413827126], [40.4416574412187, -3.62396131029291], [40.4416528446495, -3.62397836522933], [40.4416481588929, -3.62399541933871], [40.441643469782, -3.62401259368633], [40.4416388741062, -3.62402964862396], [40.4416341880777, -3.6240465848104], [40.4416295023112, -3.62406363891023], [40.4416248159055, -3.62408081091509], [40.4416202193252, -3.62409786465585], [40.4416155308485, -3.6241149187235], [40.4416108444353, -3.62413209072115], [40.4416062487419, -3.62414914564221], [40.4416015626961, -3.62416608181197], [40.4415968762753, -3.62418325380244], [40.4415922790433, -3.62420042543635], [40.4415875920827, -3.62421736276969], [40.4415829053966, -3.6242344156582], [40.4415782189466, -3.62425159117628], [40.4415736223349, -3.62426864607241], [40.4415689371724, -3.62428558223383], [40.441564247401, -3.62430287091073], [40.4415596516826, -3.6243199258081], [40.4415549656118, -3.62433686195402], [40.4415502791659, -3.6243540339205], [40.4415456834399, -3.62437108881075], [40.4415409973617, -3.62438802494954], [40.441536308476, -3.62440531362033], [40.4415317118417, -3.62442236849515], [40.4415270266568, -3.62443930463512], [40.4415223392948, -3.62445647657885], [40.4415177435348, -3.62447353499213], [40.4415130583425, -3.62449047112496], [40.4415036818055, -3.62452481379988], [40.4414990860545, -3.62454186866645], [40.4414944008523, -3.62455880478975], [40.4414897134726, -3.62457597671668], [40.4414851170835, -3.62459314830424], [40.4414804291648, -3.62461008557445], [40.4414757426848, -3.62462725632344], [40.4414711460179, -3.62464431116747], [40.4414664608008, -3.62466124727647], [40.4414617743069, -3.62467841919734], [40.4414571769826, -3.62469559429954], [40.4414524890554, -3.62471253037637], [40.4414478025539, -3.62472970229004], [40.441443205872, -3.62474675711986], [40.4414385200027, -3.62476381112166], [40.4414339242166, -3.62478086595509], [40.4414292368105, -3.62479803667177], [40.4414246410195, -3.62481509150048], [40.4414199524375, -3.62483214546769], [40.4414153557406, -3.62484920028332], [40.4414106698562, -3.6248662542708], [40.4414060740552, -3.62488330909005], [40.441401387265, -3.62490036306441], [40.4413967914589, -3.62491741787893], [40.4413921028619, -3.62493447183183], [40.4413875070381, -3.62495152899977], [40.4413828196004, -3.62496870087157], [40.4413782237843, -3.62498575567664], [40.4413735369791, -3.62500280963668], [40.4413689411643, -3.62501986325795], [40.4413642525524, -3.62503691719652], [40.4413596567262, -3.62505397199214], [40.4413549705485, -3.62507090803571], [40.4413502839941, -3.62508807989908], [40.4413456881604, -3.6251051346876], [40.4413410019753, -3.62512207072402], [40.4413363127107, -3.62513924255516], [40.4413317168696, -3.62515629733658], [40.4413270315778, -3.6251732333742], [40.4413223441138, -3.62519040403577], [40.441317748246, -3.6252074623473], [40.4413130620459, -3.62522439836943], [40.4413083743048, -3.62524145228769], [40.4413036868307, -3.62525862293967], [40.441299090972, -3.62527567770451], [40.441294404762, -3.62529261371711], [40.4412850328607, -3.62532672156549], [40.4412803435659, -3.62534389336783], [40.4412757467939, -3.62536094811248], [40.4412710614723, -3.62537788412151], [40.4412476280406, -3.6254631524522], [40.4412429427042, -3.62548008844692], [40.4412335698278, -3.62551419977148], [40.4412288805117, -3.62553137036832], [40.4412242846131, -3.62554842509523], [40.4412195983633, -3.62556536106968], [40.4412148222881, -3.62558241412167], [40.4412007616023, -3.62563357574344], [40.4411960753401, -3.62565051170593], [40.441167955694, -3.62575283370806], [40.4411631802296, -3.62576976882685], [40.4411444325144, -3.62583798774947], [40.4411396564056, -3.62585503958364], [40.4411349703737, -3.62587209342994], [40.441130282275, -3.62588902934226], [40.4411255953373, -3.62590608317541], [40.4411208192121, -3.62592313617898], [40.4411114471258, -3.62595724384997], [40.4411067596532, -3.62597406184385], [40.4411019828796, -3.6259912327442], [40.4410972959269, -3.62600828656294], [40.4410925204252, -3.6260252216455], [40.4410831456063, -3.6260593292626], [40.4410783694587, -3.62607638224434], [40.4410736824998, -3.62609343487199], [40.4410689970715, -3.62611037077826], [40.44103647776, -3.62622951774102], [40.4409085605329, -3.62669813242188], [40.4409085605329, -3.62669813242188], [40.4407949152522, -3.62711444727468], [40.44077138661, -3.62720042334244], [40.4407666988465, -3.62721759371844], [40.4407573238214, -3.62725217264975], [40.4407526366901, -3.62726922511268], [40.4407432602266, -3.6273035681927], [40.4407384832438, -3.62732074126235], [40.4407291072935, -3.62735531897709], [40.4407244192398, -3.62737237259623], [40.4407056698516, -3.62744105754298], [40.4406962920446, -3.62747563874422], [40.4406916057749, -3.62749269236326], [40.4406775414337, -3.62754420571052], [40.4406681662986, -3.62757878690779], [40.4406634791129, -3.62759584050401], [40.4406494156269, -3.62764735381616], [40.4406400395794, -3.6276819314388], [40.4406353532667, -3.62769898738707], [40.4406305762383, -3.6277161580425], [40.4406211996428, -3.62775050099681], [40.4406118235647, -3.62778507859032], [40.4406071372496, -3.627802132166], [40.440597759715, -3.62783647744589], [40.4405930721181, -3.6278537656464], [40.4405884752383, -3.62787093795614], [40.4405837892905, -3.62788775570041], [40.4405791936866, -3.6279046921944], [40.4405745960179, -3.62792151075539], [40.4405699094225, -3.62793844639811], [40.4405653138047, -3.62795538406413], [40.4405607188313, -3.62797220264328], [40.4405560322284, -3.6279891382789], [40.4405514359691, -3.62800619266431], [40.4405422424018, -3.62803982977277], [40.44053755669, -3.62805676540733], [40.4405329601605, -3.62807370186954], [40.44052836517, -3.62809052043238], [40.4405236794508, -3.62810745605987], [40.4405190829075, -3.62812439369411], [40.4405144879097, -3.62814121224996], [40.4405098895662, -3.62815814868371], [40.4405052029362, -3.62817508429337], [40.4405006079503, -3.62819189930506], [40.4404960107412, -3.62820895719109], [40.4404914157439, -3.62822577337718], [40.4404867306457, -3.62824259108043], [40.4404821334484, -3.62825964542226], [40.4404775357284, -3.62827646393432], [40.4404728506229, -3.6282932816305], [40.4404682534181, -3.62831033596529], [40.4404590624654, -3.62834397301501], [40.4404543767092, -3.62836090860708], [40.4404497810299, -3.62837784621464], [40.440445182392, -3.62839466470199], [40.4404405867141, -3.62841160112583], [40.4404359009481, -3.62842853670847], [40.4404313050054, -3.62844535521399], [40.4404267086792, -3.62846240953604], [40.4404221127316, -3.62847922803691], [40.4404174275967, -3.62849604570489], [40.4404128285605, -3.62851309999474], [40.4404082319645, -3.6285300363938], [40.4404036369016, -3.6285468560728], [40.440398951757, -3.62856367373136], [40.4403943545125, -3.6285807280286], [40.4403851634816, -3.62861436500377], [40.4403805677717, -3.62863130139723], [40.4403758792711, -3.62864823692402], [40.4403712832966, -3.62866505539925], [40.4403666869382, -3.62868210969082], [40.4403620909588, -3.6286989281614], [40.4403574057857, -3.62871574697785], [40.4403528094198, -3.62873280126237], [40.4403482127919, -3.62874973763106], [40.4403390199103, -3.62878337454288], [40.4403343331892, -3.62880031006521], [40.4403297374523, -3.62881724643294], [40.4403251414534, -3.6288340648849], [40.4403205457115, -3.62885100124796], [40.4403158598814, -3.62886793676924], [40.440311262067, -3.62888475637647], [40.4403066647755, -3.62890181062913], [40.4403020690238, -3.62891874698284], [40.4402974730102, -3.62893556542082], [40.4402927878093, -3.62895238302531], [40.4402881905078, -3.62896943726858], [40.4402789975626, -3.62900307411985], [40.4402744008953, -3.62902001045116], [40.4402697150406, -3.62903694594883], [40.4402651199236, -3.62905376202081], [40.440260522588, -3.62907081978717], [40.4402559268117, -3.62908775611751], [40.4402467356532, -3.62912138941583], [40.4402420470812, -3.62913832487418], [40.4402374503941, -3.62915526118677], [40.4402328552407, -3.6291720807796], [40.4402282579135, -3.62918913381335], [40.4402190667, -3.62922277179994], [40.4402143795387, -3.62923994189997], [40.4402003163294, -3.62929110433273], [40.4401956291516, -3.62930827560217], [40.4401910317979, -3.62932532979607], [40.440186344097, -3.62934226523431], [40.4401769701066, -3.62937637193844], [40.4401722829226, -3.62939354201683], [40.4401676855564, -3.62941059619886], [40.4401629996448, -3.629427531642], [40.4401536229269, -3.629461638297], [40.4401489357302, -3.62947880836337], [40.4401443392524, -3.62949586254197], [40.4401396524275, -3.62951279796478], [40.440134965859, -3.62952985129832], [40.4401302759305, -3.62954702486703], [40.4401256794426, -3.62956407903615], [40.4401116188061, -3.62961523899963], [40.4401069288842, -3.62963240901918], [40.440102331483, -3.62964946316804], [40.4400976455366, -3.62966639857779], [40.4400929589455, -3.62968345188979], [40.4400882708089, -3.62970062309561], [40.4400836742985, -3.62971767724339], [40.4400789856396, -3.62973461261841], [40.4400696115405, -3.62976871803342], [40.4400652911208, -3.62978453668737], [40.4400649242793, -3.62978589159372], [40.4400603268555, -3.62980294572125], [40.4400556408868, -3.62981988110956], [40.4400509515706, -3.62983693437481], [40.4400462643122, -3.62985410556742], [40.4400416662424, -3.62987127641095], [40.4400369802637, -3.62988821178972], [40.4400322936401, -3.62990526507062], [40.4400276054707, -3.62992243624521], [40.4400230062252, -3.62993949033697], [40.4400183202366, -3.62995642570619], [40.4400136336029, -3.62997347897753], [40.4400089454299, -3.62999064896348], [40.4400043488769, -3.63000770307098], [40.4399996619775, -3.63002463842227], [40.4399949726313, -3.63004169165881], [40.4399902853298, -3.6300588651807], [40.4399856887668, -3.63007591927873], [40.4399810018575, -3.63009285462049], [40.4399763152038, -3.6301099078727], [40.4399716245662, -3.63012719572702], [40.4399670279932, -3.63014424981557], [40.4399623410739, -3.63016118514778], [40.4399576544103, -3.63017823839041], [40.4399529671014, -3.630195409535], [40.4399483696175, -3.63021246360566], [40.4399436808866, -3.63022939891152], [40.4399389935766, -3.63024656886988], [40.4399343960852, -3.63026362293344], [40.4399297100494, -3.63028055825739], [40.4399250233682, -3.63029761148328], [40.439920335128, -3.63031478496076], [40.4399157358249, -3.63033183899802], [40.4399110491362, -3.63034889221672], [40.4399063618021, -3.63036606333732], [40.4399017642997, -3.63038311620525], [40.4398970782464, -3.63040005151253], [40.4398923906469, -3.63041710471326], [40.439887701501, -3.63043427580742], [40.4398831039821, -3.63045132984492], [40.4398784179189, -3.63046826514267], [40.4398737296727, -3.63048543505902], [40.4398691330472, -3.63050248909782], [40.4398644469766, -3.63051942438842], [40.4398597569147, -3.63053659545978], [40.439855159368, -3.63055365184115], [40.4398504726468, -3.63057070502879], [40.439845875751, -3.63058764114319], [40.439841189668, -3.63060457642189], [40.4398365914809, -3.6306217483399], [40.4398319961218, -3.63063856655152], [40.4398273060423, -3.63065573760614], [40.4398227093983, -3.6306727904423], [40.4398181131244, -3.63068960981753], [40.4398134263897, -3.63070666180709], [40.4398088288309, -3.63072371580681], [40.4398042328137, -3.6307406519085], [40.4397995440058, -3.63075758714062], [40.4397949464395, -3.63077464113327], [40.4397902603292, -3.6307915763859], [40.4397856630154, -3.63080874828632], [40.4397810660849, -3.63082568436784], [40.4397763799672, -3.63084261961337], [40.4397717823884, -3.63085967359422], [40.4397670935632, -3.63087660880974], [40.4397624962432, -3.63089377951929], [40.4397578999439, -3.63091059768505], [40.4397532131703, -3.63092765082273], [40.4397486162225, -3.63094458688782], [40.439743929444, -3.63096164002072], [40.4397393333921, -3.63097857608953], [40.4397346432624, -3.63099574709637], [40.4397300463048, -3.63101268315204], [40.4397253601598, -3.63102961837147], [40.4397207625407, -3.63104667468447], [40.4397160763908, -3.63106360989916], [40.4397114796804, -3.63108066385778], [40.439706790823, -3.63109759904244], [40.4397021932068, -3.63111465298792], [40.439697507047, -3.63113158819312], [40.4396929094258, -3.63114864213387], [40.439688223261, -3.63116557733432], [40.4396836265357, -3.63118263127879], [40.4396789376634, -3.63119956644921], [40.4396743400387, -3.6312166192015], [40.439669653864, -3.63123355439245], [40.4396650562279, -3.63125060831906], [40.4396603700482, -3.63126754350527], [40.4396557724071, -3.63128459742716], [40.4396510862225, -3.63130153260862], [40.4396464867747, -3.63131858650893], [40.4396418005852, -3.63133552168564], [40.4396372029341, -3.6313525755981], [40.4396325167396, -3.63136951077007], [40.4396278298987, -3.63138656384343], [40.4396232328841, -3.63140349984502], [40.4396185433421, -3.6314205517093], [40.4396139472233, -3.63143748771462], [40.4396092594716, -3.63145454077002], [40.4396045732623, -3.63147147592773], [40.4395999764921, -3.63148852982972], [40.4395952893769, -3.63150546497425], [40.4395906898992, -3.63152251884623], [40.4395860036799, -3.63153945399444], [40.4395813159132, -3.63155650703553], [40.4395767197747, -3.63157344302203], [40.439572032891, -3.63159049842486], [40.439567345761, -3.63160743355514], [40.4395627462683, -3.63162448741292], [40.4395580600342, -3.63164142254688], [40.4395534629825, -3.63165835851318], [40.4395486847315, -3.63167564533106], [40.4395393083867, -3.63171022182487], [40.4395346181489, -3.63172739272875], [40.439529929066, -3.63174468155067], [40.4395252415128, -3.63176185483308], [40.4395205533321, -3.63177914247954], [40.4395158655303, -3.63179619548705], [40.439506486447, -3.63183077192158], [40.439501798894, -3.63184794283384], [40.4394971097803, -3.63186523399684], [40.4394925123079, -3.63188240574771], [40.4394878241093, -3.63189969337721], [40.4394831338435, -3.63191686425451], [40.4394784447389, -3.63193415187072], [40.4394737571706, -3.63195132276848], [40.4394690689553, -3.6319686115673], [40.4394644705538, -3.63198578565347], [40.4394597796372, -3.63200307324312], [40.4394550920588, -3.63202024413122], [40.4394504038332, -3.63203753292036], [40.4394458054409, -3.63205470345985], [40.439436428964, -3.63208928338411], [40.4394317386767, -3.6321064530558], [40.4394271396231, -3.63212374266816], [40.4394224520269, -3.63214091353938], [40.4394177628889, -3.6321582011241], [40.4394131653732, -3.63217537283433], [40.4394084771116, -3.63219266395977], [40.43940387625, -3.63220995236424], [40.4393991877401, -3.63222712321497], [40.4393945895694, -3.632244412819], [40.4393899010609, -3.63226158248588], [40.4393853028851, -3.63227887208513], [40.4393806146081, -3.63229616319606], [40.4393760161712, -3.63231333487877], [40.4393713252059, -3.63233062242244], [40.4393667276648, -3.63234779410882], [40.439362038496, -3.63236508166454], [40.4393574403048, -3.63238237124943], [40.4393527526768, -3.63239954090548], [40.4393481529217, -3.63241695073846], [40.4393435526652, -3.63243412238759], [40.4393388650231, -3.63245129321546], [40.4393342652796, -3.63246869950416], [40.4393296677181, -3.63248587117147], [40.4393249791739, -3.63250304080465], [40.4393203803041, -3.63252045063167], [40.4393111815598, -3.63255479391587], [40.4393065852758, -3.63257172976492], [40.4393020781742, -3.63258866644761], [40.4392975726162, -3.63260548523328], [40.439292975424, -3.63262242106695], [40.4392884689602, -3.63263923983959], [40.4392839627496, -3.63265617652154], [40.43927936555, -3.63267311234826], [40.4392748599798, -3.63268993112249], [40.439270352861, -3.63270686778912], [40.439265846385, -3.63272368655035], [40.4392612500764, -3.63274062237626], [40.4392567411484, -3.6327575590191], [40.4392522346651, -3.63277437777348], [40.4392476374483, -3.63279131358397], [40.4392431318545, -3.63280813352125], [40.4392386247184, -3.63282507017181], [40.4392340283951, -3.63284200598382], [40.4392295218996, -3.63285882472674], [40.4392250147561, -3.63287576137044], [40.4392204190902, -3.63289257573536], [40.4392159119419, -3.63290951237446], [40.4392114054301, -3.63292633228729], [40.4392068991777, -3.63294326893025], [40.4392023001346, -3.6329602047007], [40.4391977936219, -3.63297702342763], [40.4391932864613, -3.63299396005527], [40.4391886907589, -3.63301077794114], [40.4391841829477, -3.63302783246714], [40.4391796773261, -3.63304465119338], [40.4391750807156, -3.63306146906387], [40.4391705735426, -3.63307840568003], [40.4391660679137, -3.63309522439941], [40.4391614706502, -3.63311216016591], [40.4391569650164, -3.63312897888072], [40.4391524578336, -3.63314591548771], [40.439147858761, -3.63316285123034], [40.439143352219, -3.63317966992983], [40.4391388459296, -3.63319660653839], [40.4391342492907, -3.63321342556714], [40.4391297414562, -3.63323047888647], [40.4391252357988, -3.63324729876431], [40.439120639159, -3.6332641166071], [40.4391161328574, -3.63328105320418], [40.4391116262983, -3.63329787188768], [40.4391071190909, -3.63331480847172], [40.4391025233421, -3.63333162631375], [40.4390980154838, -3.633348680796], [40.4390935098158, -3.63336549947882], [40.4390889104563, -3.63338231728008], [40.4390844041375, -3.63339925386111], [40.4390798975613, -3.63341607252862], [40.4390753011518, -3.63343300825955], [40.4390707939247, -3.63344994482523], [40.4390662873412, -3.63346676348588], [40.4390616909244, -3.63348369920985], [40.4390571843295, -3.63350051904496], [40.4390526779935, -3.63351745560992], [40.4390480813339, -3.6335342698787], [40.4390435734265, -3.6335513278704], [40.4390390677486, -3.6335681429887], [40.4390344692606, -3.63358496077072], [40.4390299620114, -3.63360189731576], [40.4390254553994, -3.63361871713485], [40.4390208589604, -3.63363565283798], [40.4390163523501, -3.63365247147348], [40.4390117559062, -3.63366940717197], [40.4390072486446, -3.63368634370552], [40.4390027420269, -3.63370316233416], [40.4389981455757, -3.63372009802569], [40.4389936389531, -3.63373691664975], [40.4389891325825, -3.63375385318259], [40.4389845331668, -3.63377067093074], [40.438980026145, -3.63378772536158], [40.4389755195126, -3.6338045439765], [40.438970923693, -3.63382136175156], [40.4389664164093, -3.63383829826445], [40.4389619097696, -3.63385511687252], [40.4389573132962, -3.6338720525432], [40.4389528066452, -3.63388887232572], [40.4389483002525, -3.63390580883791], [40.4389437028709, -3.63392274449318], [40.4389391962189, -3.6339395630898], [40.4389346898189, -3.63395649959512], [40.4389300912747, -3.63397331732402], [40.4389255839689, -3.63399025381628], [40.4389210773072, -3.63400707240376], [40.4389161149166, -3.63402518134348], [40.4389111509561, -3.63404341171156], [40.4389061836436, -3.63406175995399], [40.4389013097825, -3.63407998762594], [40.4388963464602, -3.63409810008347], [40.4388764869716, -3.63417101792526], [40.4388715236545, -3.63418912683219], [40.4388566298923, -3.63424381665916], [40.4388516647557, -3.63426192671738], [40.4388467934314, -3.63427968628749], [40.4388419214704, -3.63429756139931], [40.4388371375237, -3.63431532178552], [40.4388322662042, -3.63433307898982], [40.4388274856145, -3.63435071913597], [40.4388226122146, -3.63436836194448], [40.4388178303256, -3.63438623789012], [40.4388129589823, -3.63440399744215], [40.4388081777348, -3.63442175548037], [40.4387984336327, -3.63445703756256], [40.4387936517365, -3.63447491231633], [40.4387887776706, -3.63449267300906], [40.4387839964096, -3.63451043103448], [40.4387791250473, -3.63452819056843], [40.4387743444281, -3.63454583068651], [40.4387694719188, -3.63456346993812], [40.438764689086, -3.63458134820509], [40.4387598177258, -3.63459910537066], [40.4387550346275, -3.63461686690085], [40.4387501639091, -3.6346345061591], [40.4387453823599, -3.63465214861148], [40.4387425327512, -3.63466249656039], [40.4387396837888, -3.63467272660628], [40.4387369242509, -3.63468307775864], [40.4387340752867, -3.63469330780279], [40.438731315747, -3.63470365895343], [40.438728466781, -3.63471388899584], [40.4387257090347, -3.63472424134073], [40.4387228600734, -3.63473447020237], [40.4387201005235, -3.63474482252859], [40.4387172515539, -3.63475505256751], [40.4387144926561, -3.63476528581088], [40.4386996025334, -3.63481926325185], [40.4386947277674, -3.63483714179642], [40.4386897649941, -3.63485513270236], [40.4386848922841, -3.63487312799011], [40.438679927684, -3.63489112241083], [40.4386360686982, -3.6350530692048], [40.4386312833536, -3.63507106292781], [40.4386264106103, -3.635089058184], [40.4386216273215, -3.63510716865017], [40.4386168453059, -3.63512504684695], [40.4386121552115, -3.63514209937113], [40.4385983614762, -3.63519325953221], [40.4385936740744, -3.63521031207229], [40.4385798785139, -3.63526147100909], [40.4385751902012, -3.63527852353117], [40.4385705928725, -3.63529557690734], [40.4385659952884, -3.63531251237085], [40.4385613979418, -3.63532956810035], [40.43855671052, -3.63534662062141], [40.4385475122367, -3.63538072731861], [40.4385428248074, -3.63539777983252], [40.4385290309661, -3.63544893870846], [40.4385243441748, -3.63546587331111], [40.4385105484954, -3.63551703332083], [40.4385058610525, -3.63553408463669], [40.4384966654168, -3.63556819130747], [40.4384919770592, -3.63558524378671], [40.4384827795937, -3.63561935278439], [40.4384781819625, -3.63563628820327], [40.4384734951439, -3.63565322277983], [40.4384688962111, -3.6356703939973], [40.4384642988249, -3.63568744731925], [40.4384596104498, -3.63570449978184], [40.4384458146718, -3.63575565851349], [40.4384411271875, -3.63577271097504], [40.4384365297863, -3.63578976428284], [40.4384319327786, -3.63580658177663], [40.4384272446384, -3.63582375213261], [40.4384180462216, -3.63585785751874], [40.4384133587223, -3.63587490996599], [40.4384041629865, -3.63590901654245], [40.4383994761283, -3.63592595108104], [40.4383902803646, -3.63596006000138], [40.4383855901477, -3.63597711240887], [40.4383763943885, -3.63601121777801], [40.4383717059659, -3.63602827019535], [40.4383625101852, -3.63606237672932], [40.4383579133902, -3.63607931209559], [40.4383529451141, -3.6360977767565], [40.4383430134606, -3.63613446912219], [40.4383380478718, -3.63615293497936], [40.4383281161879, -3.63618962968666], [40.4383232406954, -3.63620809284775], [40.4383182757503, -3.63622643961357], [40.4383133984308, -3.6362449062893], [40.4383084334734, -3.63626325422868], [40.4383035586182, -3.63628159947758], [40.4382987756662, -3.63629912377533], [40.4382893944495, -3.63633417056746], [40.4382846141857, -3.63635169606221], [40.4382752311578, -3.63638674164348], [40.4382704508862, -3.63640426713073], [40.4382657607169, -3.63642178992793], [40.4382610702933, -3.63643919481289], [40.438256288212, -3.63645672027567], [40.4382469069541, -3.63649176584426], [40.4382421266796, -3.63650928895852], [40.4382374355807, -3.6365268140904], [40.4382326534992, -3.63654433718266], [40.4382279630572, -3.63656174205036], [40.4382232728447, -3.63657926836233], [40.4382184925635, -3.6365967902851], [40.4382138014644, -3.63661431304658], [40.4382090193566, -3.63663183848437], [40.4382043282522, -3.63664936124091], [40.4381996393382, -3.63666664938017], [40.4381090878591, -3.63699616975416], [40.4380616634864, -3.63717418388822], [40.4380616634864, -3.63717418388822], [40.4379152645461, -3.63772371294614], [40.4378575012781, -3.63793893518896], [40.4378526287415, -3.63795681212615], [40.4378478447491, -3.63797480544626], [40.4378435235317, -3.63799056527007], [40.4378429728576, -3.63799256447773], [40.4378380978733, -3.63801055693255], [40.4378333147605, -3.63802855261139], [40.4378284428738, -3.63804630927707], [40.4378186937802, -3.6380822953559], [40.4378138218657, -3.63810005555076], [40.4378089466147, -3.6381179300809], [40.4378040733997, -3.63813592489242], [40.4377992909379, -3.63815379911565], [40.4377945097489, -3.63817144225151], [40.4377898159599, -3.6381890826741], [40.4377800760206, -3.6382238920909], [40.4377752073521, -3.63824106040524], [40.4377440926276, -3.63834487758853], [40.437710647015, -3.63844725539156], [40.4376686454821, -3.63856511931968], [40.4376303508193, -3.63866427108098], [40.437579885339, -3.63878111019823], [40.4375725888314, -3.63879743127835], [40.4375346584763, -3.63887936838604], [40.43746431138, -3.6390239638434], [40.4374564744783, -3.63903992603484], [40.4374487294748, -3.63905588673458], [40.4374408943705, -3.63907184893566], [40.4374331466601, -3.63908780960243], [40.4374253115514, -3.63910377179608], [40.4374175658873, -3.63911985038081], [40.4374097289725, -3.63913581254995], [40.437394238924, -3.63916773625945], [40.4373864011149, -3.63918369605093], [40.4373786560786, -3.63919965907546], [40.4373708209676, -3.63921561888513], [40.4373553290956, -3.63924754254066], [40.437347493965, -3.63926350469719], [40.4373401109737, -3.63927899833044], [40.4373031983457, -3.63935587693943], [40.4372958175471, -3.63937113476181], [40.4372883451145, -3.6393865084394], [40.4372809627459, -3.63940188650399], [40.4372735819413, -3.63941714431627], [40.4372661989361, -3.63943263673659], [40.4372514351117, -3.63946338813466], [40.4372441434902, -3.63947864559947], [40.4372366716696, -3.63949390606985], [40.4372291994694, -3.63950939762818], [40.4372218171042, -3.63952477212874], [40.4372145254682, -3.63954003075916], [40.4372070518574, -3.63955528766192], [40.4371995794005, -3.63957066129872], [40.4371921979019, -3.63958604051027], [40.4371847260933, -3.63960129624093], [40.4371699622308, -3.63963204638563], [40.4371625804952, -3.63964730413888], [40.437155018835, -3.63966267808901], [40.4371477265155, -3.63967805694651], [40.4371402546948, -3.63969331265684], [40.4371328731997, -3.63970868830435], [40.4371253995667, -3.6397239451698], [40.4371180171732, -3.63973931962303], [40.4371105453379, -3.63975457649879], [40.437103073736, -3.63976995363684], [40.4370956919824, -3.63978521135973], [40.437088220396, -3.63980058495399], [40.4370807485528, -3.63981584181616], [40.4370733661406, -3.63983121742806], [40.4370658952007, -3.639846473113], [40.4370584208776, -3.63986185138398], [40.4370510391184, -3.63987710790764], [40.4370435675134, -3.63989248266046], [40.4370360963107, -3.63990762160322], [40.4370211521963, -3.63993836990429], [40.4370136809877, -3.6399535088369], [40.4370062093596, -3.63996888593065], [40.4369988269337, -3.63998426032967], [40.4369913539174, -3.63999939923506], [40.4369764097788, -3.64003014749523], [40.4369689394591, -3.64004528641609], [40.4369539957065, -3.64007580002843], [40.4369464326776, -3.64009141085937], [40.4369313052362, -3.64012239315037], [40.436923832698, -3.64013776783997], [40.4369011446575, -3.64018424303834], [40.4368936703094, -3.64019961769705], [40.4368785446278, -3.64023060231443], [40.4368710723232, -3.6402460948872], [40.4368635103426, -3.64026134961696], [40.4368559472823, -3.64027696158497], [40.436848472269, -3.64029245412173], [40.4368333465824, -3.6403234351604], [40.4368258748989, -3.64033881335071], [40.4368107491999, -3.64036979436852], [40.4368032741743, -3.64038528688454], [40.4367957121754, -3.64040054158323], [40.4367881490965, -3.64041615351981], [40.4367806767672, -3.6404316460511], [40.4367655510436, -3.64046262702716], [40.4367580766392, -3.64047800516083], [40.4367505133218, -3.6404934956359], [40.4367430409888, -3.64050898697092], [40.4367279152185, -3.64053997262815], [40.4367204428793, -3.64055546395279], [40.4367128783967, -3.64057083767388], [40.4367054051525, -3.64058632898307], [40.4366902793682, -3.64061731342654], [40.4366828070122, -3.64063280591288], [40.4366752436742, -3.64064829635317], [40.4366677719544, -3.64066367329218], [40.4366602068041, -3.64067916488739], [40.4366527335456, -3.64069465617239], [40.4366451710937, -3.64071014778632], [40.4366376987188, -3.6407256414309], [40.436630135362, -3.64074113302932], [40.436615189226, -3.64077188094205], [40.4366077179091, -3.64078701969049], [40.4366002452897, -3.64080239305311], [40.4365928636286, -3.64081777199209], [40.4365853923122, -3.64083290955142], [40.4365779212347, -3.64084816619313], [40.4365704486008, -3.64086354072112], [40.4365630660569, -3.64087891492208], [40.4365555956269, -3.64089405365543], [40.4365481211851, -3.64090942815609], [40.4365407386156, -3.64092480588384], [40.4365332681797, -3.64093994460706], [40.4365257961938, -3.6409552000375], [40.4365183244466, -3.6409705745502], [40.4365109418886, -3.64098594872747], [40.4365034705439, -3.64100108742862], [40.4364959987906, -3.6410164619311], [40.4364886162069, -3.64103183963517], [40.4364811457571, -3.64104697833473], [40.436473671048, -3.64106223489474], [40.4364661992933, -3.64107760820463], [40.4364588167146, -3.64109298353719], [40.4364513462568, -3.64110812222324], [40.4364364018126, -3.64113887234756], [40.4364290198797, -3.6411541297686], [40.4364215485131, -3.64116926843258], [40.4364140767442, -3.64118464171864], [40.4364066923497, -3.64120001701038], [40.4363992209772, -3.64121515566423], [40.4363917498496, -3.64123041222116], [40.4363842771521, -3.64124578902197], [40.4363768945578, -3.64126116313832], [40.4363694240782, -3.64127630178722], [40.4363619513877, -3.64129167621985], [40.4363545696882, -3.6413070503346], [40.4363470983018, -3.6413221889648], [40.4363396244576, -3.64133744547232], [40.436332151746, -3.64135282224929], [40.4363247700384, -3.64136819635051], [40.4363172986441, -3.64138333496719], [40.4363098268403, -3.64139870938456], [40.4363024442258, -3.64141408346705], [40.4362949728255, -3.6414292220736], [40.4362875016699, -3.64144447858305], [40.4362800289442, -3.6414598553362], [40.4362726472159, -3.6414752305927], [40.436265174006, -3.64149036916861], [40.4362577012938, -3.64150574237461], [40.4362503186587, -3.64152111761238], [40.4362428481453, -3.64153625620385], [40.4362353760814, -3.64155151150202], [40.4362279042424, -3.64156688823989], [40.4362205215992, -3.64158226346413], [40.4362130510778, -3.64159740204208], [40.4362055783516, -3.64161277522425], [40.4361981939006, -3.6416281504212], [40.4361907224724, -3.64164328898046], [40.4361832512888, -3.64165854544242], [40.4361757785349, -3.64167392214789], [40.436168395884, -3.64168929616946], [40.4361609253488, -3.64170443472377], [40.4361534526019, -3.64171980906108], [40.4361460708459, -3.64173518308106], [40.4361385994038, -3.64175032161666], [40.4361311255036, -3.6417655780292], [40.4361236536364, -3.64178095471939], [40.4361162709715, -3.64179632871727], [40.4361087995215, -3.64181146723936], [40.4361013276613, -3.6418268415614], [40.4360939449903, -3.64184221554912], [40.4360864744353, -3.64185735406965], [40.4360790023227, -3.64187261047557], [40.4360715295405, -3.64188798713337], [40.4360641477558, -3.64190336229509], [40.4360566744902, -3.6419185007764], [40.4360492017216, -3.64193387388707], [40.4360418196846, -3.64194913113281], [40.436037173193, -3.64195863712264], [40.4360326158852, -3.64196814395942], [40.4360279693985, -3.64197764876766], [40.4360233222498, -3.6419872726508], [40.4360188529774, -3.6419966624176], [40.4360142077913, -3.64200593260647], [40.4360095597394, -3.6420155564771], [40.4360050033148, -3.64202506567262], [40.4360003572387, -3.64203433349111], [40.4359957100722, -3.64204395972431], [40.4359910608702, -3.64205346567535], [40.4359748353409, -3.64208773911642], [40.4359586102169, -3.64212177555916], [40.4359504087091, -3.64213891142105], [40.4359422952367, -3.64215593021302], [40.4359340923312, -3.64217283024671], [40.435925890816, -3.64218996609611], [40.4359177779911, -3.64220686697866], [40.4359095771258, -3.64222388492272], [40.4359012841249, -3.6422407840827], [40.4358930805521, -3.64225780199272], [40.4358849704199, -3.64227470288454], [40.4358774043939, -3.64229031319377], [40.4358547154885, -3.64233678812021], [40.435847242003, -3.64235228021401], [40.4358169876985, -3.64241424512508], [40.435809514455, -3.64242985392801], [40.4357868227913, -3.64247632873464], [40.4357793501947, -3.64249181962687], [40.435749095816, -3.64255378441248], [40.4357416223017, -3.64256927645778], [40.4357340595876, -3.6425847700085], [40.4357264953348, -3.64260037790696], [40.435703804504, -3.64264685260714], [40.4356963309839, -3.64266234345268], [40.435683707953, -3.64268819608613], [40.435683707953, -3.64268819608613], [40.4356585137995, -3.64273979806388], [40.4356510402604, -3.64275529006759], [40.4356056593642, -3.64284823805713], [40.4354876380551, -3.64309223453384], [40.4354832634428, -3.64310127252648], [40.4354219303665, -3.64322766786928], [40.435360687232, -3.64335406501889], [40.4352993547627, -3.64348046344574], [40.4352379311895, -3.64360685723734], [40.4351765975583, -3.64373325283591], [40.4351151752685, -3.64385952827841], [40.4350537521655, -3.64398592492236], [40.4349922368072, -3.64411220019644], [40.4349308138564, -3.64423835822102], [40.4346406484979, -3.64483441166368], [40.4343549460565, -3.64542106708105], [40.4339627952825, -3.6462264664576], [40.4337437987633, -3.64667604272286], [40.4337254067597, -3.64671100173299], [40.4337071895825, -3.64674643281773], [40.4336890636156, -3.64678198383566], [40.4336712054395, -3.6468176541209], [40.4336536164377, -3.64685367948562], [40.4336362075891, -3.64688970773704], [40.4336190687952, -3.64692609461373], [40.4336021978048, -3.64696259840092], [40.433585506542, -3.64699934204889], [40.4335689929969, -3.64703620174437], [40.4335530214941, -3.64707295225567], [40.4335306828769, -3.64712072186726], [40.4335086125035, -3.64716885007411], [40.4334868101458, -3.6472172166173], [40.4334652767044, -3.64726582150576], [40.433423197661, -3.64736374451971], [40.4334025610588, -3.64741306413137], [40.4333622781333, -3.64751230225732], [40.4332530532316, -3.64779232596701], [40.4331984567484, -3.64793764129931], [40.4331745381153, -3.64800315778879], [40.4331745381153, -3.64800315778879], [40.4331716478086, -3.64801107050387], [40.4331451348826, -3.64809629115382], [40.4331199724957, -3.64818164614024], [40.4330960681839, -3.64826771935579], [40.4330734217126, -3.64835439172495], [40.4330521204502, -3.64844166644919], [40.4330319925142, -3.64852918818717], [40.4330132091168, -3.64861743136002], [40.4329958643738, -3.64870615990156], [40.4329796895772, -3.6487952556943], [40.4329647739501, -3.64888471252637], [40.4329513883638, -3.64897442336146], [40.4329405243835, -3.64904823981235], [40.4329298420833, -3.64912194126736], [40.4329192476036, -3.6491958781605], [40.4329086537189, -3.64926970067495], [40.4328878252828, -3.64941734319594], [40.4328775006326, -3.64949116469433], [40.4328672662527, -3.64956510611552], [40.4328571236996, -3.6496390507558], [40.4328470685021, -3.64971299267755], [40.4328443517274, -3.64973312824486], [40.4328371040056, -3.64978681755235], [40.4327408613661, -3.65048160542177], [40.4326444304227, -3.65117709450699], [40.4325405756507, -3.65192639016366], [40.4324831183255, -3.65233882928738], [40.4324441449311, -3.65262046032896], [40.4323868599747, -3.65303384428752], [40.4322905958918, -3.6537289751331], [40.4321942335203, -3.65442433882289], [40.4321140230259, -3.6550036088762], [40.432013129245, -3.65573476539368], [40.4319440813656, -3.65623456556809], [40.4319410891384, -3.65625636615429], [40.4319410891384, -3.65625636615429], [40.4319303625189, -3.65633452612575], [40.4319027407995, -3.6565344441496], [40.4318890216943, -3.65663440458173], [40.4318752124243, -3.65673436291681], [40.4318614935856, -3.65683408747729], [40.4318433754178, -3.65696300623899], [40.4318253462778, -3.65709192815551], [40.431807318579, -3.65722072976278], [40.4317892891526, -3.65734965153787], [40.4317713496817, -3.65747857176182], [40.4317534116188, -3.65760737757143], [40.4317355612827, -3.65773641524284], [40.4317177114672, -3.65786533613368], [40.4316999542829, -3.65799426021667], [40.4316821041808, -3.65812318096757], [40.4316644340927, -3.65825210576304], [40.4315524291988, -3.65906378460354], [40.4313433533567, -3.66057763539797], [40.4312424844506, -3.66129828388454], [40.4312132574882, -3.66150690748969], [40.4311487523263, -3.66196736105865], [40.4311438865319, -3.66199914495775], [40.4311393803949, -3.66203105027417], [40.4311350535188, -3.66206295734434], [40.4311309959888, -3.66209486705205], [40.431127210058, -3.66212701520945], [40.4311236015863, -3.66215916510384], [40.4311203543476, -3.66219131853812], [40.4311171974176, -3.66222358957104], [40.4311144005874, -3.66225574741764], [40.431111781674, -3.66228814161766], [40.4311095230733, -3.66232101446621], [40.431109183734, -3.66234895220397], [40.431109208563, -3.66237606707206], [40.4311093225701, -3.66240318281519], [40.4311096196557, -3.66243042060756], [40.4311100933155, -3.66245765777498], [40.4311107495964, -3.66248478237695], [40.4311115835845, -3.66251202308136], [40.4311126893984, -3.66253914855939], [40.4311138868541, -3.66256615940081], [40.4311152622354, -3.66259340542123], [40.4311169071768, -3.6626207743413], [40.4311216760475, -3.66266927356236], [40.4311272572153, -3.66271719600611], [40.4311334703319, -3.66276488533542], [40.4311404948719, -3.66281246474541], [40.4311482432212, -3.66285981666154], [40.431156711114, -3.66290705658037], [40.431165993571, -3.66295395318357], [40.431175996248, -3.66300061990421], [40.4311866299678, -3.66304705468885], [40.4311980800409, -3.66309314853765], [40.4312103372864, -3.66313924561524], [40.4312223729325, -3.66317732603101], [40.4312346781481, -3.66321505542364], [40.4312472574377, -3.66325243383764], [40.4312602869303, -3.66328969643604], [40.4312736805624, -3.66332661247845], [40.4312874343126, -3.66336341182121], [40.4313014576201, -3.66339986250043], [40.4313159372063, -3.66343608070966], [40.4313306841165, -3.6634721824876], [40.4313458854906, -3.66350805413664], [40.4313612695196, -3.66354333576313], [40.4314492784061, -3.66374898510978], [40.4316526823783, -3.66422616972429]], line: "5", destination: "Casa de Campo", color: "#8FD400" },
          { id: 13364, source: 15, target: 21, distance: 4.68, duration: 16, transportMode: "Metro", steps: [], "polyline": [[40.4271015086962, -3.65012111184286], [40.427272150134, -3.65105152251572], [40.4274108316365, -3.6513944401972], [40.4283434779723, -3.65370068907775], [40.4293139771974, -3.65587531194593], [40.4298231544858, -3.65730120248281], [40.430538053524, -3.65893211378537], [40.430792047062, -3.65974657075395], [40.4308383688925, -3.66069433624164], [40.4308275470047, -3.66258885552778], [40.430443246195, -3.66388106480192], [40.430443246195, -3.66388106480192], [40.4301852007728, -3.66448990709332], [40.4301065634628, -3.66467658536943], [40.4300560867902, -3.6647907994171], [40.4299897541538, -3.66493680255093], [40.4299372156607, -3.66504934539715], [40.4299147859067, -3.66509569323697], [40.4295321486145, -3.66588357098994], [40.42908551516, -3.66680119441299], [40.4289073560111, -3.66716973258203], [40.4287371068763, -3.66752525879965], [40.4286617026039, -3.66768119091474], [40.4285392804639, -3.66792920028579], [40.4284851463712, -3.66803689028218], [40.4284362451599, -3.66812765218041], [40.4283538432065, -3.66827820743628], [40.4282788306291, -3.66841327402612], [40.4280561778496, -3.66881001112071], [40.4278036377905, -3.66926468417177], [40.427693748068, -3.66946388794924], [40.4275844849557, -3.66966357120664], [40.4273668474645, -3.6700852207662], [40.4273668474645, -3.6700852207662], [40.4269941682142, -3.67080724036154], [40.4267572290022, -3.67127360921626], [40.426394236983, -3.67202259029178], [40.4263133605322, -3.67218880439575], [40.4258014080655, -3.67324246675437], [40.4256407085261, -3.67357483440038], [40.4255571407379, -3.67375448159136], [40.4254599298662, -3.67397159980223], [40.4251461742326, -3.6746939317905], [40.4250911937708, -3.67482175835288], [40.4249965991056, -3.6750380733178], [40.424943806674, -3.67516156066688], [40.4247735946887, -3.67555323538707], [40.4245385016728, -3.67608607575084], [40.4243890881779, -3.67641851283005], [40.4243890881779, -3.67641851283005], [40.4242559989929, -3.67671462968587], [40.4241893694399, -3.67686260961149], [40.423896450568, -3.67751533744401], [40.4238609540256, -3.6775926644008], [40.4232895511026, -3.67886193594596], [40.4228392260631, -3.67986906212215], [40.4227266639956, -3.68012125316323], [40.4226578387335, -3.68027403851788], [40.4226229580293, -3.68035325960622], [40.4225281630617, -3.68056526490217], [40.4225281630617, -3.68056526490217], [40.4224931433183, -3.68064358486469], [40.4224220930605, -3.68080707494605], [40.4223480809425, -3.68096817840587], [40.4220800360034, -3.68156960507985], [40.4217496431257, -3.68230911879035], [40.4209521711596, -3.68409400099804], [40.4209148206355, -3.68417955255161], [40.4208937129299, -3.6842295554332], [40.4208732346059, -3.68427991829136], [40.4208594256775, -3.68431490448233], [40.4208337788616, -3.68438596004471], [40.4208215842439, -3.68442202462363], [40.420804415961, -3.68447630967136], [40.4207883237737, -3.68453143309347], [40.4207687871694, -3.68460561405449], [40.4207525280742, -3.68467369861704], [40.4207212217755, -3.68481848727981], [40.4206881535409, -3.68497917244502], [40.4206594448152, -3.68511868273882], [40.4206204701397, -3.68531077831355], [40.4205875965955, -3.68547665035209], [40.4205662211793, -3.68558735498217], [40.4205300792103, -3.68577228833403], [40.4204966647056, -3.68593827112674], [40.4204249273121, -3.68630248673314], [40.4204249273121, -3.68630248673314], [40.4203694103415, -3.68658435096607], [40.4203390134823, -3.68674246713884], [40.4202851460666, -3.68701444821951], [40.4202153143262, -3.68736547649456], [40.4201802917939, -3.6875439373419], [40.4201565765392, -3.68766888212082], [40.420099172423, -3.68795968341242], [40.420040529498, -3.68826202572625], [40.420023419662, -3.68835143543352], [40.420010563248, -3.68842308928173], [40.4199866411431, -3.68856747956747], [40.4199681397072, -3.6886940056359], [40.4199537969796, -3.68880324757358], [40.4199410602196, -3.68891510027983], [40.4199314685547, -3.68901271859914], [40.4199232307703, -3.6891103530627], [40.4199175386199, -3.68918868313507], [40.4198943044436, -3.68958073203732], [40.4198879795629, -3.68967461390795], [40.4198754657567, -3.68982430415645], [40.419861983291, -3.68995512326546], [40.4198508908241, -3.69004789782333], [40.4197883030387, -3.69051191890181], [40.4196423138038, -3.69157565602656], [40.4195996702782, -3.69188240051738], [40.4195853127569, -3.69199376158279], [40.4195749354413, -3.69208689283598], [40.419567642339, -3.69216143267421], [40.4195599633891, -3.69225541783609], [40.4195508858549, -3.69249295977686], [40.4195476630418, -3.6925498589316], [40.4195448246404, -3.69258754966056], [40.4195397107045, -3.69264431153559], [40.4195333365685, -3.69270059015709], [40.419528516957, -3.69273814267498], [40.4195171716195, -3.6928127575158], [40.4195107328732, -3.69284958733792], [40.4194963295232, -3.69292334564361], [40.4194754251274, -3.69301425040229], [40.4194448432355, -3.69314135635852], [40.4194267528854, -3.69321366455063], [40.4193007858348, -3.6937132160866], [40.4192799324624, -3.69379551487795], [40.4192633057208, -3.69386406225053], [40.419230993779, -3.69399421672231], [40.4191801725579, -3.69420645677702], [40.4191511115819, -3.69433511316624], [40.4191055682474, -3.69455318280168], [40.4190717845943, -3.69471868123784], [40.4190440482404, -3.6948666809191], [40.419039187886, -3.6948957562986], [40.419039187886, -3.6948957562986], [40.4189343430585, -3.69552281432843], [40.4189117692742, -3.69566638618583], [40.4189003858261, -3.69573145053463], [40.4188954060036, -3.69576582060774], [40.4188619574502, -3.69596456163511], [40.4188264396143, -3.6961629310511], [40.4187992685828, -3.69630680868441], [40.4187746420196, -3.6964322087168], [40.4187380948661, -3.69660675193715], [40.4187070841961, -3.69674634969811], [40.4186994815279, -3.6967805723067], [40.4186544607385, -3.69697082502671], [40.4186202089618, -3.69710849949037], [40.4185798118587, -3.69726426513677], [40.4185412980135, -3.69740649350255], [40.4184961929799, -3.69756574398361], [40.418438814715, -3.69775858136088], [40.4183685347654, -3.69798416912674], [40.4179172573293, -3.69938983931772], [40.4178565650365, -3.69957898160671], [40.417821490241, -3.69968823874706], [40.4177505277304, -3.69991047253266]], line: "2", destination: "Cuatro Caminos", color: "#ED1C24" },
          { id: 13365, source: 21, target: 22, distance: 0.39, duration: 5, transportMode: "A pie", steps: ["0-6:Camina hacia el oeste", "6-14:¡Gire ligeramente a la derecha!", "14-15:¡Gire a la derecha a Plaza de la Puerta del Sol!", "15-16:¡Gire a la derecha a Plaza de la Puerta del Sol!", "16-16:Llegar a Plaza de la Puerta del Sol, a la derecha"], "polyline": [[40.418065, -3.699258], [40.418059, -3.699279], [40.418061, -3.699337], [40.418056, -3.699349], [40.418044, -3.699379], [40.41803, -3.699413], [40.418003, -3.699446], [40.41799, -3.699484], [40.417913, -3.699743], [40.417799, -3.70009], [40.417323, -3.701627], [40.417241, -3.702048], [40.417146, -3.702421], [40.416979, -3.702841], [40.416892, -3.703092], [40.416832, -3.703345], [40.416929, -3.703413]], line: null, destination: null, color: "#2D2E2D" }
        ]
      };

      //this.sharedService.showToast('No se ha podido obtener la ruta', 3000);
      //this.router.navigate(['/']);
    }

    // Iterate over the segments of the route
    this.route.segments.forEach((segment, index) => {
      // Transform some lines to unify zones in one line
      if (linesZone.has(segment.line)) {
        segment.line = linesZone.get(segment.line);
      }

      // Insert the steps if applicable
      if (segment.steps && segment.steps.length) {
        // Init list for the steps
        let steps = [];
        segment.steps.forEach((step: string) => {
          // Split way-points & instruction
          let parts = step.split(':', 2);
          // Get the source/target point & the instruction
          let wayPoints = parts[0].split('-', 2);
          let first = wayPoints[0];
          let last = wayPoints[1];
          let instruction = parts[1];
          steps.push({ first: first, last: last, instruction: instruction });
        });
        this.segmentsSteps.set(index, steps);
      }

      // Dash pattern for the segment (for walk segments)
      let dashedSegment = segment.transportMode === 'A pie';
      // Icon (mode of transport) for the segment
      let iconSegment = iconTransport.get(segment.transportMode);

      // Store some features of the segments
      this.segmentsVisual.push({ dashed: dashedSegment, icon: iconSegment });
    });
  }

  ionViewDidEnter() {
    this.isOpen = true;

    // OpenStreetMap
    // https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png
    const standard = L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });

    const satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
      attribution: '&copy; Esri'
    });

    const layers = {
      "<span style='cursor: pointer'>Satélite</span>": satellite,
      "<span style='cursor: pointer'>Predeterminado</span>": standard
    };

    this.map = L.map('map', {
      zoomControl: false,
      center: [40.416694, -3.703250],
      zoom: 12,
      layers: [standard, satellite]
    });

    L.control.zoom({ position: 'topright' }).addTo(this.map);
    L.control.layers(layers, null, { position: 'topright' }).addTo(this.map);


    let multiPolyline: L.Polyline<LineString | MultiLineString, any>;
    let coordinates = [];
    // Iterate over the segments of the route
    this.route.segments.forEach((segment, index) => {
      // Transform number[][] to LatLng array in polyline
      let coords = segment.polyline.map(coord => new L.LatLng(coord[0], coord[1]));

      // Establish the color for the segment
      let color = segment.color;
      // Dash pattern for the segment (for walk segments)
      let dashArray = this.segmentsVisual[index].dashed ? '1 7' : null;
      // Image to be used as icon
      let iconSegment = this.segmentsVisual[index].icon;

      // Tooltip set line if applicable
      let lineTooltip = segment.line ?
        '<ion-badge mode="md" style="margin-left: 3px; background-color: '
        + color
        + '; color: #ffffff;">'
        + segment.line
        + '</ion-badge>' : '';
      // Tooltip for the polylines that make up the route
      let tooltip =
        '<div style="text-align: center">'
        + '<div style="display: block"><img style="height: 20px; width: 20px; margin: 0px auto;" src="./assets/'
        + iconSegment + '">'
        + lineTooltip
        + '</div>'
        + this.route.points[segment.source].name
        + '<ion-icon style="vertical-align: middle; font-size: 9px; opacity: 0.7" name="chevron-forward-outline"></ion-icon>'
        + this.route.points[segment.target].name
        + '</div>';

      // Add polyline to map
      L.polyline(coords, {
        stroke: true,
        color: color,
        weight: 5,
        lineJoin: 'round',
        lineCap: 'round',
        dashArray: dashArray
      }).bindTooltip(tooltip, {
        sticky: true
      }).addTo(this.map);

      // Add the coordinates of each segment
      coordinates.push.apply(coordinates, coords);

      // Icon for marker
      let icon = L.icon({
        iconUrl: './assets/' + iconSegment,
        iconSize: [20, 20]
      });

      // Add markers to map
      new L.Marker([this.route.points[segment.source].latitude, this.route.points[segment.source].longitude], {
        icon: icon
      }).addTo(this.map).bindTooltip(this.route.points[segment.source].name);
    });

    // Marker for destination point
    new L.Marker([this.route.destination.latitude, this.route.destination.longitude], {
      icon: L.icon({ iconUrl: './assets/destination.png', iconSize: [25, 25] })
    }).addTo(this.map).bindTooltip(this.route.destination.name);

    // Polyline of the whole route
    multiPolyline = L.polyline(coordinates);
    this.map.fitBounds(multiPolyline.getBounds(), { paddingTopLeft: [this.showSideMenu ? 300 : 0, 0] });

    // Remove highlighted polyline if 
    this.map.on('zoomend', () => this.closeStep());
  }

  // Close/open sidemenu
  toggleMenu() {
    this.isOpen = !this.isOpen;
  }

  // When step in walk or bike is selected
  zoomToStep(first: number, last: number, index: number) {
    // If there is already a polyline highlighted remove it from the map
    if (this.stepSelected) {
      this.map.removeLayer(this.stepSelected);
    }

    // Get coordinates to highlight & zoom
    let polyline = this.route.segments[index].polyline.slice(first, ++last)
      .map(coord => new L.LatLng(coord[0], coord[1]));;

    // Add polyline to map
    this.stepSelected = L.polyline(polyline, {
      stroke: true,
      color: '#2D2E2D',
      weight: 5,
      lineJoin: 'round',
      lineCap: 'round'
    }).addTo(this.map);
    // Zoom to polyline
    this.map.fitBounds(this.stepSelected.getBounds(), { paddingTopLeft: [this.showSideMenu ? 150 : 0, 0] });
  }

  // Remove polyline highlighted from map
  closeStep() {
    // Already polyline & zoom has to be lower than 16
    if (this.stepSelected && this.map.getZoom() <= 15) {
      this.map.removeLayer(this.stepSelected);
      this.stepSelected = undefined;
    }
  }

}
